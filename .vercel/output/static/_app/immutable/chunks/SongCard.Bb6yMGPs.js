import{s as _e,n as re,c as V,b as Ge,r as Ue,a as we,d as H}from"./scheduler.C6UnpWtt.js";import{S as me,i as de,k as ke,l as ye,a as E,d as p,m as h,g as L,h as m,e as y,v as ze,s as C,c as T,w as De,f as P,x as Ie,B as I,r as z,u as je,p as q,q as Me,y as Fe,t as ie,b as ce,j as ue,E as Te,F as Ee,n as He,H as fe,o as he,z as Je,J as ae}from"./index.C08rKovH.js";import{e as Z}from"./each.BhP_wiSw.js";import{i as Y,c as K,a as oe}from"./store.CG4JpFtH.js";import{f as Ne}from"./Seekbar2.C0G3k09u.js";import{p as Ke}from"./stores.DLGMNiH6.js";import{f as Be}from"./index.tk3XMavp.js";function Qe(t){let e,l;return{c(){e=ke("svg"),l=ke("path"),this.h()},l(r){e=ye(r,"svg",{xmlns:!0,width:!0,height:!0,viewBox:!0});var n=E(e);l=ye(n,"path",{fill:!0,d:!0}),E(l).forEach(p),n.forEach(p),this.h()},h(){h(l,"fill","currentColor"),h(l,"d","M10.001 7.8a2.2 2.2 0 1 0 0 4.402A2.2 2.2 0 0 0 10 7.8zm0-2.6A2.2 2.2 0 1 0 9.999.8a2.2 2.2 0 0 0 .002 4.4zm0 9.6a2.2 2.2 0 1 0 0 4.402a2.2 2.2 0 0 0 0-4.402z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"width","20"),h(e,"height","20"),h(e,"viewBox","0 0 20 20")},m(r,n){L(r,e,n),m(e,l)},p:re,i:re,o:re,d(r){r&&p(e)}}}class Re extends me{constructor(e){super(),de(this,e,null,Qe,_e,{})}}function Oe(t){let e,l,r,n,i,a,c,s,u,f;return{c(){e=y("div"),l=y("button"),r=ie(t[1]),n=C(),i=y("button"),a=ie(t[2]),this.h()},l(_){e=T(_,"DIV",{class:!0});var v=E(e);l=T(v,"BUTTON",{class:!0});var O=E(l);r=ce(O,t[1]),O.forEach(p),n=P(v),i=T(v,"BUTTON",{class:!0});var b=E(i);a=ce(b,t[2]),b.forEach(p),v.forEach(p),this.h()},h(){h(l,"class","hover"),h(i,"class","hover"),h(e,"class","absolute right-8 bg-zinc-900 text-white w-40 flex flex-col gap-2 rounded py-2")},m(_,v){L(_,e,v),m(e,l),m(l,r),m(e,n),m(e,i),m(i,a),s=!0,u||(f=[I(l,"click",t[7]),I(i,"click",t[8])],u=!0)},p(_,v){(!s||v&2)&&ue(r,_[1]),(!s||v&4)&&ue(a,_[2])},i(_){s||(_&&Ge(()=>{s&&(c||(c=Te(e,Be,{},!0)),c.run(1))}),s=!0)},o(_){_&&(c||(c=Te(e,Be,{},!1)),c.run(0)),s=!1},d(_){_&&p(e),_&&c&&c.end(),u=!1,Ue(f)}}}function We(t){let e,l,r,n,i,a,c;r=new Re({});let s=t[3]&&Oe(t);return{c(){e=y("div"),l=y("button"),ze(r.$$.fragment),n=C(),s&&s.c(),this.h()},l(u){e=T(u,"DIV",{class:!0});var f=E(e);l=T(f,"BUTTON",{class:!0});var _=E(l);De(r.$$.fragment,_),_.forEach(p),n=P(f),s&&s.l(f),f.forEach(p),this.h()},h(){h(l,"class","w-full flex justify-center items-center hover rounded transition duration-300"),h(e,"class","relative flex justify-center w-8")},m(u,f){L(u,e,f),m(e,l),Ie(r,l,null),m(e,n),s&&s.m(e,null),i=!0,a||(c=I(l,"click",t[4]),a=!0)},p(u,[f]){u[3]?s?(s.p(u,f),f&8&&z(s,1)):(s=Oe(u),s.c(),z(s,1),s.m(e,null)):s&&(je(),q(s,1,1,()=>{s=null}),Me())},i(u){i||(z(r.$$.fragment,u),z(s),i=!0)},o(u){q(r.$$.fragment,u),q(s),i=!1},d(u){u&&p(e),Fe(r),s&&s.d(),a=!1,c()}}}function Xe(t,e,l){let r,n,i;V(t,Y,o=>l(9,r=o)),V(t,K,o=>l(10,n=o)),V(t,Ke,o=>l(11,i=o));let{item:a}=e,c="Copy Link",s="Play Next",u=!1;const f=()=>l(3,u=!u);async function _(o){try{await navigator.clipboard.writeText(`${i.url.origin}/song/${o}`),l(1,c="âœ“ Copied!"),setTimeout(()=>l(1,c="Copy Link"),1500)}catch(d){console.error("Failed to copy: ",d)}setTimeout(()=>l(3,u=!u),500)}async function v(o){n.some(d=>d.id===o.id)===!1?(n.splice(r+1,0,o),l(2,s="âœ“ Up Next!"),setTimeout(()=>l(2,s="Play Next"),1500)):(l(2,s="ðŸ—™ Song already in list."),setTimeout(()=>l(2,s="Play Next"),1500)),setTimeout(()=>l(3,u=!u),500)}const O=()=>_(a.id),b=()=>v(a);return t.$$set=o=>{"item"in o&&l(0,a=o.item)},[a,c,s,u,f,_,v,O,b]}class Ye extends me{constructor(e){super(),de(this,e,Xe,We,_e,{item:0})}}function Se(t,e,l){const r=t.slice();return r[12]=e[l],r[14]=l,r}function Ce(t,e,l){const r=t.slice();r[15]=e[l],r[14]=l;const n=r[12].more_info.artistMap.primary_artists;return r[16]=n,r}function Pe(t){let e,l,r=(t[14]!==t[16].length-1?t[15].name+", ":t[15].name)+"",n;return{c(){e=y("a"),l=new fe(!1),this.h()},l(i){e=T(i,"A",{class:!0,href:!0});var a=E(e);l=he(a,!1),a.forEach(p),this.h()},h(){l.a=null,h(e,"class","truncate hover:underline hover:underline-offset-1"),h(e,"href",n="/artist/"+t[15].id)},m(i,a){L(i,e,a),l.m(r,e)},p(i,a){a&1&&r!==(r=(i[14]!==i[16].length-1?i[15].name+", ":i[15].name)+"")&&l.p(r),a&1&&n!==(n="/artist/"+i[15].id)&&h(e,"href",n)},d(i){i&&p(e)}}}function Ae(t){let e,l,r,n,i,a,c,s,u,f,_,v=t[12].title+"",O,b,o,d,$="-",x,A,G,Q=t[12].subtitle.split("- ")[1]+"",R,ee,j,J=Ne(t[12].more_info.duration)+"",W,te,U,le,S,ne,pe;function Ve(){return t[3](t[12],t[14])}function qe(){return t[4](t[12],t[14])}let M=Z(t[12].more_info.artistMap.primary_artists),w=[];for(let g=0;g<M.length;g+=1)w[g]=Pe(Ce(t,M,g));function Le(){return t[5](t[12],t[14])}function xe(){return t[6](t[12],t[14])}return U=new Ye({props:{item:t[12]}}),{c(){e=y("div"),l=y("button"),r=y("button"),n=y("img"),c=C(),s=y("button"),u=y("div"),f=y("button"),_=new fe(!1),O=C(),b=y("span");for(let g=0;g<w.length;g+=1)w[g].c();o=C(),d=y("span"),d.textContent=$,x=C(),A=y("a"),G=new fe(!1),ee=C(),j=y("span"),W=ie(J),te=C(),ze(U.$$.fragment),le=C(),this.h()},l(g){e=T(g,"DIV",{class:!0});var k=E(e);l=T(k,"BUTTON",{class:!0});var B=E(l);r=T(B,"BUTTON",{});var N=E(r);n=T(N,"IMG",{class:!0,src:!0,alt:!0}),N.forEach(p),c=P(B),s=T(B,"BUTTON",{class:!0});var D=E(s);u=T(D,"DIV",{class:!0});var X=E(u);f=T(X,"BUTTON",{class:!0});var ge=E(f);_=he(ge,!1),ge.forEach(p),O=P(X),b=T(X,"SPAN",{});var F=E(b);for(let se=0;se<w.length;se+=1)w[se].l(F);o=P(F),d=T(F,"SPAN",{"data-svelte-h":!0}),Je(d)!=="svelte-1s4sarz"&&(d.textContent=$),x=P(F),A=T(F,"A",{class:!0,href:!0});var ve=E(A);G=he(ve,!1),ve.forEach(p),F.forEach(p),X.forEach(p),ee=P(D),j=T(D,"SPAN",{class:!0});var be=E(j);W=ce(be,J),be.forEach(p),D.forEach(p),B.forEach(p),te=P(k),De(U.$$.fragment,k),le=P(k),k.forEach(p),this.h()},h(){h(n,"class","rounded h-14"),we(n.src,i=t[12].image)||h(n,"src",i),h(n,"alt",a=t[12].title),_.a=null,h(f,"class","font-bold truncate text-sm text-left"),G.a=null,h(A,"class","truncate hover:underline hover:underline-offset-1"),h(A,"href",R="/album/"+t[12].more_info.album_id),h(u,"class","flex flex-col leading-3 items-start text-gray-300 text-xs"),h(j,"class","text-xs hidden lg:inline"),h(s,"class","info flex w-full overflow-hidden justify-between items-center xl:pr-2"),h(l,"class","song flex hover items-center w-full overflow-hidden gap-2 rounded"),h(e,"class","songcard cursor-pointer flex")},m(g,k){L(g,e,k),m(e,l),m(l,r),m(r,n),m(l,c),m(l,s),m(s,u),m(u,f),_.m(v,f),m(u,O),m(u,b);for(let B=0;B<w.length;B+=1)w[B]&&w[B].m(b,null);m(b,o),m(b,d),m(b,x),m(b,A),G.m(Q,A),m(s,ee),m(s,j),m(j,W),m(e,te),Ie(U,e,null),m(e,le),S=!0,ne||(pe=[I(r,"click",Ve),I(f,"click",ae(qe)),I(s,"click",ae(Le)),I(l,"click",ae(xe))],ne=!0)},p(g,k){if(t=g,(!S||k&1&&!we(n.src,i=t[12].image))&&h(n,"src",i),(!S||k&1&&a!==(a=t[12].title))&&h(n,"alt",a),(!S||k&1)&&v!==(v=t[12].title+"")&&_.p(v),k&1){M=Z(t[12].more_info.artistMap.primary_artists);let N;for(N=0;N<M.length;N+=1){const D=Ce(t,M,N);w[N]?w[N].p(D,k):(w[N]=Pe(D),w[N].c(),w[N].m(b,o))}for(;N<w.length;N+=1)w[N].d(1);w.length=M.length}(!S||k&1)&&Q!==(Q=t[12].subtitle.split("- ")[1]+"")&&G.p(Q),(!S||k&1&&R!==(R="/album/"+t[12].more_info.album_id))&&h(A,"href",R),(!S||k&1)&&J!==(J=Ne(t[12].more_info.duration)+"")&&ue(W,J);const B={};k&1&&(B.item=t[12]),U.$set(B)},i(g){S||(z(U.$$.fragment,g),S=!0)},o(g){q(U.$$.fragment,g),S=!1},d(g){g&&p(e),He(w,g),Fe(U),ne=!1,Ue(pe)}}}function Ze(t){let e,l,r=Z(t[0]),n=[];for(let a=0;a<r.length;a+=1)n[a]=Ae(Se(t,r,a));const i=a=>q(n[a],1,1,()=>{n[a]=null});return{c(){for(let a=0;a<n.length;a+=1)n[a].c();e=Ee()},l(a){for(let c=0;c<n.length;c+=1)n[c].l(a);e=Ee()},m(a,c){for(let s=0;s<n.length;s+=1)n[s]&&n[s].m(a,c);L(a,e,c),l=!0},p(a,[c]){if(c&3){r=Z(a[0]);let s;for(s=0;s<r.length;s+=1){const u=Se(a,r,s);n[s]?(n[s].p(u,c),z(n[s],1)):(n[s]=Ae(u),n[s].c(),z(n[s],1),n[s].m(e.parentNode,e))}for(je(),s=r.length;s<n.length;s+=1)i(s);Me()}},i(a){if(!l){for(let c=0;c<r.length;c+=1)z(n[c]);l=!0}},o(a){n=n.filter(Boolean);for(let c=0;c<n.length;c+=1)q(n[c]);l=!1},d(a){a&&p(e),He(n,a)}}}function $e(t,e,l){let r,n,i;V(t,Y,o=>l(7,r=o)),V(t,K,o=>l(8,n=o)),V(t,oe,o=>l(9,i=o));let{list:a=[]}=e,{type:c}=e;async function s(o){H(K,n=[o],n),H(Y,r=0,r),H(oe,i=n[r],i),(await(await fetch(`/api/reco?songid=${i.id}`)).json()).forEach(x=>{n.push(x)}),K.set(n)}function u(o,d){a.length!==0&&H(K,n=a,n),H(Y,r=d,r),H(oe,i=n[r],i)}const f=(o,d)=>{c==="song"?s(o):u(o,d)},_=(o,d)=>f(o,d),v=(o,d)=>f(o,d),O=(o,d)=>f(o,d),b=(o,d)=>f(o,d);return t.$$set=o=>{"list"in o&&l(0,a=o.list),"type"in o&&l(2,c=o.type)},[a,f,c,_,v,O,b]}class ot extends me{constructor(e){super(),de(this,e,$e,Ze,_e,{list:0,type:2})}}export{ot as S};
